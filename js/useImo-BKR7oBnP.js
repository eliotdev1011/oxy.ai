import{b3 as z,b4 as V,b5 as Y,b6 as Z,b7 as x,b8 as $,b9 as h,Y as C,ba as D,bb as q,M as d,bc as J,a0 as b,a as X,bd as ee,Z as g,be as te,bf as v,bg as ne,bh as ae,bi as se,bj as ie}from"./index-Dg322SbI.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new t.Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="c2f5e7ea-57b5-46ea-9ce0-ef60c50f49b8",t._sentryDebugIdIdentifier="sentry-dbid-c2f5e7ea-57b5-46ea-9ce0-ef60c50f49b8")}catch{}})();async function re(t,s){const{account:e,chainId:n,connector:a,...r}=s;let o;return typeof e=="object"&&(e==null?void 0:e.type)==="local"?o=t.getClient({chainId:n}):o=await z(t,{account:e??void 0,chainId:n,connector:a}),await V(o,Y,"writeContract")({...r,...e?{account:e}:{},chain:n?{id:n}:null})}function oe(t,s={}){return{async queryFn({queryKey:e}){const n=s.abi;if(!n)throw new Error("abi is required");const{functionName:a,scopeKey:r,...o}=e[1],c=(()=>{const i=e[1];if(i.address)return{address:i.address};if(i.code)return{code:i.code};throw new Error("address or code is required")})();if(!a)throw new Error("functionName is required");return Z(t,{abi:n,functionName:a,args:o.args,...c,...o})},queryKey:ue(s)}}function ue(t={}){const{abi:s,...e}=t;return["readContract",x(e)]}function de(t,s={}){return{async queryFn({queryKey:e}){var c;const n=[],a=e[1].contracts.length;for(let i=0;i<a;i++){const u=e[1].contracts[i],p=((c=s.contracts)==null?void 0:c[i]).abi;n.push({...u,abi:p})}const{scopeKey:r,...o}=e[1];return $(t,{...o,contracts:n})},queryKey:ce(s)}}function ce(t={}){const s=[];for(const e of t.contracts??[]){const{abi:n,...a}=e;s.push({...a,chainId:a.chainId??t.chainId})}return["readContracts",x({...t,contracts:s})]}function pe(t){return{mutationFn(s){return re(t,s)},mutationKey:["writeContract"]}}function S(t={}){const{abi:s,address:e,functionName:n,query:a={}}=t,r=t.code,o=h(t),c=C({config:o}),i=oe(o,{...t,chainId:t.chainId??c}),u=!!((e||r)&&s&&n&&(a.enabled??!0));return D({...a,...i,enabled:u,structuralSharing:a.structuralSharing??q})}function M(t={}){const{contracts:s=[],query:e={}}=t,n=h(t),a=C({config:n}),r=de(n,{...t,chainId:a}),o=d.useMemo(()=>{let c=!1;for(const i of s){const{abi:u,address:p,functionName:l}=i;if(!u||!p||!l){c=!1;break}c=!0}return!!(c&&(e.enabled??!0))},[s,e.enabled]);return D({...r,...e,enabled:o,structuralSharing:e.structuralSharing??q})}function B(t={}){const{mutation:s}=t,e=h(t),n=pe(e),{mutate:a,mutateAsync:r,...o}=J({...s,...n});return{...o,writeContract:a,writeContractAsync:r}}const m=[{type:"constructor",inputs:[{name:"_raiseStartTime",type:"uint256",internalType:"uint256"},{name:"_raiseEndTime",type:"uint256",internalType:"uint256"},{name:"_imoTokenAddress",type:"address",internalType:"address"},{name:"_raiseTokenAddress",type:"address",internalType:"address"},{name:"_targetRaisingAmount",type:"uint256",internalType:"uint256"},{name:"_WETH",type:"address",internalType:"address"},{name:"_liquidityPool",type:"address",internalType:"address"},{name:"_owner",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"ETH_IDENTIFIER",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"WETH",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"accumulatedRaiseAmount",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"balanceOf",inputs:[{name:"user",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"claimAndRefund",inputs:[],outputs:[{name:"claimableAmount",type:"uint256",internalType:"uint256"},{name:"refundAmount",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"claimable",inputs:[{name:"user",type:"address",internalType:"address"}],outputs:[{name:"claimableAmount",type:"uint256",internalType:"uint256"},{name:"refundAmount",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"collectRaisedToken",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"deposit",inputs:[{name:"raiseAmount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"payable"},{type:"function",name:"getDepositBalancesByUsers",inputs:[{name:"userAddresses",type:"address[]",internalType:"address[]"}],outputs:[{name:"",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getIMORemaining",inputs:[],outputs:[{name:"remaining",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"getTwapPrice",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"imoToken",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"liquidityPool",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"moveIMOTokens",inputs:[{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"owner",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"ownerCollected",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"raiseEndTime",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"raiseStartTime",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"raiseToken",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"refund",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"renounceOwnership",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setIMOTokenAddress",inputs:[{name:"_imoTokenAddress",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setLiquidityPool",inputs:[{name:"_liquidityPool",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setRaisePeriod",inputs:[{name:"_raiseStartTime",type:"uint256",internalType:"uint256"},{name:"_raiseEndTime",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setRaiseTokenAddress",inputs:[{name:"_raiseTokenAddress",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setTargetRaisingAmount",inputs:[{name:"_targetRaisingAmount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"status",inputs:[],outputs:[{name:"",type:"uint8",internalType:"enum IIMOv2.Status"}],stateMutability:"view"},{type:"function",name:"targetRaisingAmount",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"transferOwnership",inputs:[{name:"newOwner",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"userDepositBalance",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"event",name:"Claimed",inputs:[{name:"claimer",type:"address",indexed:!0,internalType:"address"},{name:"imoAmount",type:"uint256",indexed:!0,internalType:"uint256"},{name:"refundAmount",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"Deposit",inputs:[{name:"depositor",type:"address",indexed:!0,internalType:"address"},{name:"depositAmount",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"IMOTokenMoved",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"NewIMOTokenAddress",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"NewRaiseTimes",inputs:[{name:"raiseStartTime",type:"uint256",indexed:!0,internalType:"uint256"},{name:"raiseEndTime",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"NewRaiseTokenAddress",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"NewSwapLiquidityPool",inputs:[{name:"NewSwapLiquidityPool",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"NewTargetRaisingAmount",inputs:[{name:"targetRaisingAmount",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OwnerCollect",inputs:[{name:"raiseToken",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OwnershipTransferred",inputs:[{name:"previousOwner",type:"address",indexed:!0,internalType:"address"},{name:"newOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"Refund",inputs:[{name:"refunder",type:"address",indexed:!0,internalType:"address"},{name:"refundAmount",type:"uint256",indexed:!0,internalType:"uint256"}],anonymous:!1},{type:"error",name:"OwnableInvalidOwner",inputs:[{name:"owner",type:"address",internalType:"address"}]},{type:"error",name:"OwnableUnauthorizedAccount",inputs:[{name:"account",type:"address",internalType:"address"}]},{type:"error",name:"ReentrancyGuardReentrantCall",inputs:[]}];var ye=(t=>(t[t.Init=0]="Init",t[t.OnSale=1]="OnSale",t[t.RaiseSuccess=2]="RaiseSuccess",t[t.RaiseFailed=3]="RaiseFailed",t))(ye||{});function fe({chainId:t,tokenAddress:s,decimals:e=18,staleTime:n=1/0}){const{isConnected:a,address:r}=g(),{data:o=0n,isLoading:c,refetch:i}=S({chainId:t,address:s,abi:v,functionName:"balanceOf",args:[r],query:{enabled:a&&!!r&&!!t&&!!s,staleTime:n}}),u=d.useMemo(()=>te(o,e),[o,e]);return{isLoading:c,balance:o,formattedBalance:u,refetch:i}}function E({chainId:t,tokenAddress:s,contractAddress:e,staleTime:n=1/0}){const{isConnected:a,address:r}=g(),{data:o=0n,isLoading:c,refetch:i}=S({chainId:t,address:s,abi:v,functionName:"allowance",args:[r,e],query:{enabled:a&&!!r&&!!t&&!!e,staleTime:n}}),u=d.useMemo(()=>b(o)||"0",[o]);return{isFetchingAllowance:c,allowance:u,refetchAllowance:i}}function be(t,s){const{address:e}=g(),{writeContractAsync:n}=B(),{chainId:a,contractAddress:r}=A(t),{isFetchingAllowance:o,allowance:c,refetchAllowance:i}=E({chainId:a,tokenAddress:s,contractAddress:r}),[u,p]=d.useState(!1),l=d.useCallback(async(T=115792089237316195423570985008687907853269984665640564039457584007913129639935n)=>{if(!(!a||!e)){p(!0);try{const w=await n({chainId:a,address:s,abi:v,functionName:"approve",args:[r,T]});await ne({hash:w}),i()}finally{p(!1)}}},[a,e,r]);return{isFetchingAllowance:o,allowance:c,refetchAllowance:i,onApprove:l,isApproving:u}}function A(t){const s=C(),e=X(p=>ee(p,t)),n=d.useMemo(()=>Object.keys(e.contract).some(p=>Number(p)===Number(s))?s:Number(Object.keys(e.contract)[0]),[e]),a=d.useMemo(()=>{var p;return(p=e.contract)==null?void 0:p[n]},[n,e]),r=d.useMemo(()=>{var p;return(p=e.depositRewardAsset)==null?void 0:p[n]},[n,e]),o=d.useMemo(()=>{var p,l;return(l=(p=e.depositSupportedAssets)==null?void 0:p[n])==null?void 0:l.assets},[n,e]),c=d.useMemo(()=>a==null?void 0:a.address,[o]),i=d.useMemo(()=>r==null?void 0:r.address,[r]),u=d.useMemo(()=>{var p;return(p=o==null?void 0:o.find(l=>l.symbol==="ORA"))==null?void 0:p.address},[o]);return{chainId:n,imoInfo:e,contract:a,depositRewardAsset:r,depositSupportedAssets:o,oraTokenAddress:u,contractAddress:c,rewardTokenAddress:i}}function le(t){const{isConnected:s,address:e}=g(),{chainId:n}=A(t),{data:a,isLoading:r,refetch:o}=ae({chainId:n,address:e,query:{enabled:s&&!!e&&!!n}}),c=d.useMemo(()=>(a==null?void 0:a.value)??0n,[a==null?void 0:a.value]),i=d.useMemo(()=>b(c),[c]);return{nativeBalance:c,formattedNativeBalance:i,isFetchingNativeBalance:r,refetchNativeBalance:o}}function Te(t){const{chainId:s,contractAddress:e}=A(t),{data:n,isLoading:a}=M({allowFailure:!1,contracts:[{chainId:s,address:e,abi:m,functionName:"targetRaisingAmount"},{chainId:s,address:e,abi:m,functionName:"raiseStartTime"},{chainId:s,address:e,abi:m,functionName:"raiseEndTime"}],query:{enabled:!!s,staleTime:1/0}}),r=d.useMemo(()=>b((n==null?void 0:n[0])??0n),[n==null?void 0:n[0]]),o=d.useMemo(()=>Number((n==null?void 0:n[1])??0),[n==null?void 0:n[1]]),c=d.useMemo(()=>Number((n==null?void 0:n[2])??0),[n==null?void 0:n[2]]),{data:i,isLoading:u,refetch:p}=M({allowFailure:!1,contracts:[{chainId:s,address:e,abi:m,functionName:"status"},{chainId:s,address:e,abi:m,functionName:"accumulatedRaiseAmount"}],query:{enabled:!!s,staleTime:1/0,refetchInterval:1e3*60}}),l=d.useMemo(()=>(i==null?void 0:i[0])??0,[i==null?void 0:i[0]]),T=d.useMemo(()=>b((i==null?void 0:i[1])??0n)||"0",[i==null?void 0:i[1]]),w=d.useMemo(()=>a||u,[a,u]);return{targetRaisingAmount:r,accumulatedRaiseAmount:T,isFetchingimoContractConfigData:w,refetchImoContractConfigData:p,imoStatus:l,raiseStartTime:o,raiseEndTime:c}}function we(t){var R,k,_;const{isConnected:s,address:e}=g(),{writeContractAsync:n}=B(),{chainId:a,contractAddress:r,oraTokenAddress:o}=A(t),{nativeBalance:c}=le(t),{allowance:i}=E({chainId:a,tokenAddress:o,contractAddress:r}),{data:u,isLoading:p,refetch:l}=M({contracts:[{chainId:a,address:r,abi:m,functionName:"balanceOf",args:[e]},{chainId:a,address:r,abi:m,functionName:"claimable",args:[e]}],query:{enabled:s&&!!e&&!!a}}),T=d.useMemo(()=>{var y;return b(((y=u==null?void 0:u[0])==null?void 0:y.result)??0n)},[(R=u==null?void 0:u[0])==null?void 0:R.result]),w=d.useMemo(()=>{var y,f;return b(((f=(y=u==null?void 0:u[1])==null?void 0:y.result)==null?void 0:f[0])??0n)},[(k=u==null?void 0:u[1])==null?void 0:k.result]),F=d.useMemo(()=>{var y,f;return b(((f=(y=u==null?void 0:u[1])==null?void 0:y.result)==null?void 0:f[1])??0n)},[(_=u==null?void 0:u[1])==null?void 0:_.result]),[P,L]=d.useState("0"),[G,I]=d.useState(!1),Q=d.useCallback(async()=>{if(!(!e||(c??0n)===0n||se(i||0).lt(1)))try{I(!0);const y=await ie();if(!y)return;const f=await y.estimateContractGas({address:r,abi:m,functionName:"deposit",account:e,args:[1n]}),{gasPrice:U}=await y.estimateFeesPerGas({type:"legacy"});L(b(f*U))}catch{}finally{I(!1)}},[e,c,i]);d.useEffect(()=>{Q()},[e,c,i]);const[j,N]=d.useState(!1),K=d.useCallback(async(y,f)=>{if(!a||!e)throw new Error("ChainId or address is not defined");N(!0);try{return await n({chainId:a,address:r,abi:m,functionName:"deposit",args:[y],value:f})}finally{N(!1)}},[a,e,r]),[W,O]=d.useState(!1),H=d.useCallback(async(y=!1)=>{if(!a||!e)throw new Error("ChainId or address is not defined");O(!0);try{return await n({chainId:a,address:r,abi:m,functionName:y?"refund":"claimAndRefund"})}finally{O(!1)}},[a,e,r]);return{isFetchingDepositedAmount:p,depositedAmount:T,claimableAmount:w,refundAmount:F,refetchDepositedAmount:l,depositGas:P,isEstimatingDepositGas:G,onDeposit:K,isDepositing:j,onClaimOrRefund:H,isClaiming:W}}export{ye as E,A as a,we as b,le as c,be as d,fe as e,Te as u};
